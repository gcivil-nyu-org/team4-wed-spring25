{% extends "base.html" %}

{% block content %}
<div class="container my-4">
    <!-- Park Heading -->
    <div class="text-center bg-brown text-white py-3 rounded">
        <h1>{{ park.name }}</h1>
    </div>

    <!-- Park Image -->
    <div class="text-center mt-3">
        {% if park.image %}
            <img src="{{ park.image.url }}" alt="{{ park.name }} Image" class="img-fluid rounded shadow">
        {% else %}
            <img src="https://www.miracle-recreation.com/content/uploads/2018/11/Image-Header_Park.jpg.webp" 
                 alt="Dog Park Image" class="img-fluid rounded shadow">
        {% endif %}
    </div>

    <!-- Park Details Table -->
    <div class="table-responsive mt-4">
        <table class="table table-bordered">
            <tr><th>Address</th><td>{{ park.address }}</td></tr>
            <tr><th>Dog Runs Type</th><td>{{ park.dogruns_type }}</td></tr>
            <tr><th>Accessible</th><td>{{ park.accessible }}</td></tr>
            <tr><th>Notes</th><td>{{ park.notes }}</td></tr>
        </table>
    </div>

    <!-- Review Section -->
    <div class="card mt-5">
        <div class="card-header bg-brown text-white">
            <h4>Upload a Picture & Leave a Review</h4>
        </div>
        <div class="card-body">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Image Upload -->
                <div class="mb-3">
                    <label class="form-label">Upload an Image:</label>
                    <input type="file" name="image" accept="image/*" class="form-control">
                </div>

                <!-- Review Input -->
                <div class="mb-3">
                    <label class="form-label">Your Review:</label>
                    <textarea name="text" class="form-control" rows="4" required></textarea>
                </div>

                <!-- Star Rating System -->
                <label class="form-label">Rating:</label>
                <div class="stars mb-3">
                    <span class="star" data-value="1">&#9733;</span>
                    <span class="star" data-value="2">&#9733;</span>
                    <span class="star" data-value="3">&#9733;</span>
                    <span class="star" data-value="4">&#9733;</span>
                    <span class="star" data-value="5">&#9733;</span>
                </div>
                <input type="hidden" name="rating" id="star-rating" required>

                <!-- Submit Button -->
                <button type="submit" class="btn btn-brown">Submit Review</button>
            </form>
        </div>
    </div>

    <!-- Back Button -->
    <div class="text-center mt-3">
        <a href="{% url 'park_and_map' %}" class="btn btn-secondary">Go Back</a>
    </div>
</div>

<!-- JavaScript for Star Rating -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const stars = document.querySelectorAll('.star');
        const ratingInput = document.getElementById('star-rating');

        stars.forEach(star => {
            star.addEventListener('click', function () {
                const ratingValue = this.getAttribute('data-value');
                ratingInput.value = ratingValue;

                stars.forEach(s => s.classList.remove('selected'));
                for (let i = 0; i < ratingValue; i++) {
                    stars[i].classList.add('selected');
                }
            });
        });
    });
</script>

<!-- Custom Styles -->
<style>
    .bg-brown { background-color: #6D4C41; }
    .btn-brown { background-color: #6D4C41; color: white; }
    .btn-brown:hover { background-color: #5D4037; }
    .stars { display: flex; justify-content: center; font-size: 30px; cursor: pointer; }
    .star { color: #ccc; transition: color 0.2s ease-in-out; }
    .star.selected { color: #ffcc00; }
</style>
{% endblock %}
