{% extends 'base.html' %}
{% load humanize %}

{% block content %}
<div class="container mt-5">
    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h4 class="mb-0">Your Messages</h4>
        </div>
        <div class="card-body">
            {% if grouped_messages %}
                <div class="list-group">
                    {% for sender_username, msgs in grouped_messages.items %}
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <a href="{% url 'chat_view' sender_username %}" class="text-decoration-none text-dark flex-grow-1">
                                <h6 class="mb-1 fw-bold">{{ sender_username }}</h6>
                                <p class="mb-0 text-muted">{{ msgs.0.content|truncatechars:60 }}</p>
                                <small class="text-muted">{{ msgs.0.timestamp|naturaltime }}</small>
                            </a>
                            <form method="post" action="{% url 'delete_conversation' sender_username %}" onsubmit="return confirm('Are you sure you want to delete this conversation?');">
                                {% csrf_token %}
                                <button class="btn btn-sm btn-outline-danger ms-3">
                                    🗑️
                                </button>
                            </form>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p class="text-muted">You have no messages yet.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}